(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{72:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return a})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var s=n(3),i=n(7),o=(n(0),n(101)),r={id:"introDoc2",title:"Use Case as Code",sidebar_label:"Use Case as Code",slug:"/introduction/use-cases"},a={unversionedId:"introDoc2",id:"introDoc2",isDocsHomePage:!1,title:"Use Case as Code",description:"We\u2019ve already talked about the complexity of business rules and how we try to solve this with herbsJS, but if you look closely you can see that at the center of the clean architecture concept, you\u2019ll notice that * use cases * are at the center of everything, that's where the business rule is, along with the entities that guide and model the behavior of that system. HerbsJS was born from there, to try to describe complex business rules in an easy way for humans and machines to read.",source:"@site/docs/intro-use-case-as-code.md",slug:"/introduction/use-cases",permalink:"/website/docs/introduction/use-cases",editUrl:"https://github.com/herbsjs/website/edit/master/website/docs/intro-use-case-as-code.md",version:"current",sidebar_label:"Use Case as Code",sidebar:"someSidebar",previous:{title:"What's HerbsJs",permalink:"/website/docs/"},next:{title:"Architecture guides",permalink:"/website/docs/introduction/architecture-guidelines"}},c=[],d={toc:c};function u(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(s.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"We\u2019ve already talked about the complexity of business rules and how we try to solve this with herbsJS, but if you look closely you can see that at the center of the clean architecture concept, you\u2019ll notice that ",Object(o.b)("em",{parentName:"p"}," use cases ")," are at the center of everything, that's where the business rule is, along with the entities that guide and model the behavior of that system. HerbsJS was born from there, to try to describe complex business rules in an easy way for humans and machines to read."),Object(o.b)("p",null,"Here we can see an example of a use case implemented with ",Object(o.b)("strong",{parentName:"p"}," buchu "),", one of the herbsJS libs:"),Object(o.b)("pre",null,Object(o.b)("code",Object(s.a)({parentName:"pre"},{className:"language-js"}),'usecase("Add or Update an Item on a to-do List", {\n        request: { listId: Number, item: Object },\n\n        authorize: (user) => user.isAdmin ? Ok() : Err(),\n\n        setup: (ctx) => ctx.di = Object.assign({}, dependency, injection),\n\n        "Check if the Item is valid": step((ctx) => {\n            const item = ctx.ret.item = new ctx.di.Item(ctx.req.item)\n            return item.validate() // Ok or Error\n        }),\n\n        "Check if the List exists": step(async (ctx) => {\n            const listRepo = new ctx.di.ListRepository(ctx.di)\n            const list = await listRepo.first(ctx.req.listId)\n            const hasList = (list != null)\n            if (!hasList) { return Err("List does not exist. listId: " + ctx.req.listId) }\n            return Ok()\n        }),\n\n        "Add or Update the Item": ifElse({\n\n            "If the Item exists": step(async (ctx) => {\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                const item = await itemRepo.firstLike(ctx.req.item.name)\n                const newItem = (item == null)\n                if (!newItem) ctx.ret.item = item\n                return Ok(newItem)\n            }),\n\n            "Then: Add a new Item to the List": step(async (ctx) => {\n                const item = ctx.ret.item = new ctx.di.Item(ctx.req.item)\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                return await itemRepo.save(item) // Ok or Error\n            }),\n\n            "Else: Update Item on the List": step(async (ctx) => {\n                const item = ctx.ret.item\n                item.name = ctx.req.item.name\n                item.position = ctx.req.item.position\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                return await itemRepo.save(item) // Ok or Error\n            })\n        })\n    })\n')),Object(o.b)("p",null,"With just one method, you can generate documentation for that usecase:"),Object(o.b)("pre",null,Object(o.b)("code",Object(s.a)({parentName:"pre"},{className:"language-js"}),"console.log(uc.doc())\n/*\n {\n  type: 'use case',\n  description: 'Add or Update an Item on a to-do List',\n  steps: [\n    {\n      type: 'step',\n      description: 'Check if the Item is valid',\n      steps: null\n    },\n    {\n      type: 'step',\n      description: 'Check if the List exists',\n      steps: null\n    },\n    {\n      description: 'Add or Update the Item',\n      type: 'if else',\n      if: [Object],\n      then: [Object],\n      else: [Object]\n    }\n  ],\n  request: { listId: [Function: Number], item: [Function: Object] }\n}*/\n")),Object(o.b)("p",null,"And with another, you can audit it:"),Object(o.b)("pre",null,Object(o.b)("code",Object(s.a)({parentName:"pre"},{className:"language-js"}),"uc.audit()\n/* {\n  type: 'use case',\n  description: 'Add or Update an Item on a to-do List',\n  transactionId: 'c7702d26-aad2-4641-9bc3-409fc5a310f7',\n  user: { user: 'John', id: '923b8b9a', isAdmin: true },\n  authorized: true,\n  return: Ok { value: { item: [Item] } },\n  steps: [\n    {\n      type: 'step',\n      description: 'Check if the Item is valid',\n      return: [Ok],\n      elapsedTime: 64400n\n    },\n    {\n      type: 'step',\n      description: 'Check if the List exists',\n      return: [Ok],\n      elapsedTime: 53700n\n    },\n    {\n      type: 'if else',\n      description: 'Add or Update the Item',\n      returnIf: [Ok],\n      returnThen: [Ok],\n      elapsedTime: 119300n\n    }\n  ],\n  elapsedTime: 802300n\n}*/\n")))}u.isMDXComponent=!0}}]);