(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{117:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},b=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),b=p(n),d=a,m=b["".concat(s,".").concat(d)]||b[d]||u[d]||i;return n?r.a.createElement(m,c(c({ref:t},l),{},{components:n})):r.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,s=new Array(i);s[0]=d;var c={};for(var o in t)hasOwnProperty.call(t,o)&&(c[o]=t[o]);c.originalType=e,c.mdxType="string"==typeof e?e:a,s[1]=c;for(var l=2;l<i;l++)s[l]=n[l];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},99:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return p}));var a=n(3),r=n(7),i=(n(0),n(117)),s={id:"whatis",title:"What's a Use Case?",sidebar_label:"What's a Use Case?",slug:"/usecase"},c={unversionedId:"usecase/whatis",id:"usecase/whatis",isDocsHomePage:!1,title:"What's a Use Case?",description:"// TODO",source:"@site/docs/usecase/whatis.md",slug:"/usecase",permalink:"/docs/usecase",editUrl:"https://github.com/herbsjs/herbsjs.github.io/docs/usecase/whatis.md",version:"current",sidebar_label:"What's a Use Case?",sidebar:"sidebar",previous:{title:"Result",permalink:"/docs/usecase/result"},next:{title:"Getting started",permalink:"/docs/entity/getting-started"}},o=[{value:"Herbs Use Case",id:"herbs-use-case",children:[{value:"Maintainability",id:"maintainability",children:[]},{value:"Metadata for system intent",id:"metadata-for-system-intent",children:[]},{value:"Auditable and Secure",id:"auditable-and-secure",children:[]}]},{value:"Concepts",id:"concepts",children:[]},{value:"Best pratices",id:"best-pratices",children:[{value:"Architecture",id:"architecture",children:[]},{value:"References",id:"references",children:[]}]}],l={toc:o};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"// TODO"),Object(i.b)("h2",{id:"herbs-use-case"},"Herbs Use Case"),Object(i.b)("h3",{id:"maintainability"},"Maintainability"),Object(i.b)("p",null,'"Programs must be written for people to read, and only incidentally for machines to execute" - Harold Abelson, Structure and Interpretation of Computer Programs'),Object(i.b)("p",null,"Understanding what a software is doing from a business perspective is a must in order to be able to change it quickly and in a sustainable way."),Object(i.b)("h3",{id:"metadata-for-system-intent"},"Metadata for system intent"),Object(i.b)("p",null,"It should be easy to retrieve a system's metadata for all its use cases and steps. This info could be used to leverage innovative interfaces (ex: dynamic admin pages, use case documentations, etc), helping narrow the gap between developers, testers and product managers."),Object(i.b)("h3",{id:"auditable-and-secure"},"Auditable and Secure"),Object(i.b)("p",null,"It should be easy to have enterprise grade features even for simple applications. Authorization and auditing, for instance, should be available out of the box. Not using should be opt-in."),Object(i.b)("h2",{id:"concepts"},"Concepts"),Object(i.b)("p",null,"Conceptually, a use case reflects a single action exposed by the Domain to the end user."),Object(i.b)("p",null,"For exemple: ",Object(i.b)("em",{parentName:"p"},"Reopen Ticket"),", ",Object(i.b)("em",{parentName:"p"},"Reply Message"),", ",Object(i.b)("em",{parentName:"p"},"Add User")),Object(i.b)("p",null,"Internally a Use Case is responsible to control the interaction between entities, repositories and other domain components."),Object(i.b)("p",null,"It should:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Be modeled around business"),Object(i.b)("li",{parentName:"ul"},"Be reusable"),Object(i.b)("li",{parentName:"ul"},"Be testable"),Object(i.b)("li",{parentName:"ul"},"Have clear acceptance criteria"),Object(i.b)("li",{parentName:"ul"},"Use Ubiquitous language")),Object(i.b)("p",null,'From Clean Architecture book: "Use cases orchestrate the flow of data to and from the entities, and direct those entities to use their Critical Business Rules to achieve the goals of the use case." '),Object(i.b)("h2",{id:"best-pratices"},"Best pratices"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Keep it simple by telling stories"),Object(i.b)("li",{parentName:"ul"},"Focus on value"),Object(i.b)("li",{parentName:"ul"},"Build the use case in steps")),Object(i.b)("h3",{id:"architecture"},"Architecture"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Implement business ",Object(i.b)("strong",{parentName:"p"},"flows")," using Use Cases."),Object(i.b)("p",{parentName:"li"},"Ex: ",Object(i.b)("em",{parentName:"p"},"Reply Message")," use case interacts with ",Object(i.b)("inlineCode",{parentName:"p"},"Message"),", ",Object(i.b)("inlineCode",{parentName:"p"},"Ticket"),", ",Object(i.b)("inlineCode",{parentName:"p"},"User")," and others entities in order to reply a message for a user")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Split the ",Object(i.b)("strong",{parentName:"p"},"flows")," in smaller steps")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Avoid implement ",Object(i.b)("strong",{parentName:"p"},"validations")," using Use Cases. Prefer Entities for validations")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Access Use Cases from outside the Domain"),Object(i.b)("p",{parentName:"li"},'Use cases are the "entry points" for the Domain layer, so it is the only accessible layer from outside the Domain.')),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Don't access any other sublayer which belongs to Domain layer (Entities, etc) apart Use Case from outside Domain")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Name the Use Case folder, file and its steps  as an action (verb)."),Object(i.b)("p",{parentName:"li"},"Ex: ",Object(i.b)("inlineCode",{parentName:"p"},"OpenTicket.js"),", ",Object(i.b)("inlineCode",{parentName:"p"},"ReplyMessage.js"),", ",Object(i.b)("inlineCode",{parentName:"p"},"AddUser.js")),Object(i.b)("p",{parentName:"li"},"Use Cases are implemented as ",Object(i.b)("a",{parentName:"p",href:"https://sourcemaking.com/design_patterns/command"},"command patterns"),"."))),Object(i.b)("h3",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Clean Architecture book ",Object(i.b)("a",{parentName:"li",href:"https://www.amazon.com/Clean-Architecture-Craftsmans-Software-Structure/dp/0134494164"},"link")),Object(i.b)("li",{parentName:"ul"},"Use Case 2.0 ",Object(i.b)("a",{parentName:"li",href:"https://www.ivarjacobson.com/sites/default/files/field_iji_file/article/use-case_2.0_final_rev3.pdf"},"link")),Object(i.b)("li",{parentName:"ul"},"Use Case diagram ",Object(i.b)("a",{parentName:"li",href:"http://www.agilemodeling.com/artifacts/useCaseDiagram.htm"},"link")),Object(i.b)("li",{parentName:"ul"},"Service Layer ",Object(i.b)("a",{parentName:"li",href:"https://martinfowler.com/eaaCatalog/serviceLayer.html"},"link"))),Object(i.b)("hr",null),Object(i.b)("p",null,"We\u2019ve already talked about the complexity of business rules and how we try to solve this with Herbs, but if you look closely you can see that at the center of the clean architecture concept, you\u2019ll notice that ",Object(i.b)("em",{parentName:"p"}," use cases ")," are at the center of everything, that's where the business rule is, along with the entities that guide and model the behavior of that system. Herbs was born from there, to try to describe complex business rules in an easy way for humans and machines to read."),Object(i.b)("p",null,"Here we can see an example of a use case implemented with ",Object(i.b)("strong",{parentName:"p"}," buchu "),", one of the Herbs libs:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},'usecase("Add or Update an Item on a to-do List", {\n        request: { listId: Number, item: Object },\n\n        authorize: (user) => user.isAdmin ? Ok() : Err(),\n\n        setup: (ctx) => ctx.di = Object.assign({}, dependency, injection),\n\n        "Check if the Item is valid": step((ctx) => {\n            const item = ctx.ret.item = new ctx.di.Item(ctx.req.item)\n            return item.validate() // Ok or Error\n        }),\n\n        "Check if the List exists": step(async (ctx) => {\n            const listRepo = new ctx.di.ListRepository(ctx.di)\n            const list = await listRepo.first(ctx.req.listId)\n            const hasList = (list != null)\n            if (!hasList) { return Err("List does not exist. listId: " + ctx.req.listId) }\n            return Ok()\n        }),\n\n        "Add or Update the Item": ifElse({\n\n            "If the Item exists": step(async (ctx) => {\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                const item = await itemRepo.firstLike(ctx.req.item.name)\n                const newItem = (item == null)\n                if (!newItem) ctx.ret.item = item\n                return Ok(newItem)\n            }),\n\n            "Then: Add a new Item to the List": step(async (ctx) => {\n                const item = ctx.ret.item = new ctx.di.Item(ctx.req.item)\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                return await itemRepo.save(item) // Ok or Error\n            }),\n\n            "Else: Update Item on the List": step(async (ctx) => {\n                const item = ctx.ret.item\n                item.name = ctx.req.item.name\n                item.position = ctx.req.item.position\n                const itemRepo = new ctx.di.ItemRepository(ctx.di)\n                return await itemRepo.save(item) // Ok or Error\n            })\n        })\n    })\n')),Object(i.b)("p",null,"With just one method, you can generate documentation for that usecase:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"console.log(uc.doc())\n/*\n {\n  type: 'use case',\n  description: 'Add or Update an Item on a to-do List',\n  steps: [\n    {\n      type: 'step',\n      description: 'Check if the Item is valid',\n      steps: null\n    },\n    {\n      type: 'step',\n      description: 'Check if the List exists',\n      steps: null\n    },\n    {\n      description: 'Add or Update the Item',\n      type: 'if else',\n      if: [Object],\n      then: [Object],\n      else: [Object]\n    }\n  ],\n  request: { listId: [Function: Number], item: [Function: Object] }\n}*/\n")),Object(i.b)("p",null,"And with another, you can audit it:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"uc.audit()\n/* {\n  type: 'use case',\n  description: 'Add or Update an Item on a to-do List',\n  transactionId: 'c7702d26-aad2-4641-9bc3-409fc5a310f7',\n  user: { user: 'John', id: '923b8b9a', isAdmin: true },\n  authorized: true,\n  return: Ok { value: { item: [Item] } },\n  steps: [\n    {\n      type: 'step',\n      description: 'Check if the Item is valid',\n      return: [Ok],\n      elapsedTime: 64400n\n    },\n    {\n      type: 'step',\n      description: 'Check if the List exists',\n      return: [Ok],\n      elapsedTime: 53700n\n    },\n    {\n      type: 'if else',\n      description: 'Add or Update the Item',\n      returnIf: [Ok],\n      returnThen: [Ok],\n      elapsedTime: 119300n\n    }\n  ],\n  elapsedTime: 802300n\n}*/\n")))}p.isMDXComponent=!0}}]);